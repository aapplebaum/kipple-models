# kipple-models
This repository houses the models associated with the _kipple_ project. It is large! ~500MB.

## Models ##
Each model is a gradient-boosted decision tree (GBDT) implemented in LightGBM, similar to [EMBER](https://github.com/elastic/ember). In total, there are 16 kipple models; these models are described in detail in the kipple presentation and paper, though we summarize them below.

### Initial Model ###
The initial model -- ```initial.txt.gz``` -- was trained only on the EMBER data following the EMBER labels.

### Retrained Model ###
The retrained model -- ```retrained.txt.gz``` -- was trained on the EMBER data as well as the adversarially generated malware. It treats the EMBER benignware as benign, EMBER malware as malware, and adversarially generated variants as malware, discarding the EMBER unknownware.

### Adversarially Trained Models ###
Each of the adversarially trained models follows the following ideas:

* Treats some subset of the adversarially generated variants as malware;
* Treats EMBER benignware as benign (labeled as **benign**); and
* Either treats EMBER malware and unknownware as benign or discards it (labeled as **all**).

The adversarially trained models are labeled as ```<adversarial-variants>_<ember-strategy>```. In total there are six adversarial variant datasets:
* **adversarial** -- this includes all adversarial variants;
* **variants** -- this includes all variants generated by Malware RL or SecML Malware;
* **malware_rl** -- this includes variants generated by Malware RL;
* **secml** -- this includes variants generated by SecML Malware;
* **msf** -- this includes variants generated by msfvenom; and
* **undetec** -- this includes variants generated by msfvenom that evaded the _initial_ model.
We also include two other models -- **adversarial_misc** and **variants_misc** -- where the EMBER strategy was unknown.

The following table summarizes each of the models:

| Name      | Malicious | Benign |
| ------------| ------------| ------------|
| initial | EMBER malware | EMBER benignware|
| retrained | EMBER malware + all variants | EMBER benignware|
| adversarial_all | all variants | all EMBER|
| variants_all | all Malware RL and SecML variants | all EMBER|
| malware_rl_all | all Malware RL variants | all EMBER|
| secml_all | all SecML variants| all EMBER|
| msf_all | all msfvenom variants| all EMBER|
| undetect_all | all evasive msfvenom variants| all EMBER|
| adversarial_benign | all variants | EMBER benignware|
| variants_benign | all Malware RL and SecML variants | EMBER benignware|
| malware_rl_benign | all Malware RL variants | EMBER benignware|
| secml_benign | all SecML variants| EMBER benignware|
| msf_benign | all msfvenom variants| EMBER benignware|
| undetect_benign | all evasive msfvenom variants| EMBER benignware|
| adversarial_misc | all variants | unknown |
| variants_misc | all variants | unknown |

## Usage ##
